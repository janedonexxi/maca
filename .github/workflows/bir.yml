- name: Setup Multiple Tunnel Options (Fixed) sonnet
  run: |
    echo "ðŸš€ Setting up tunnel options..."
    
    # Method 1: Install bore via Homebrew (more reliable)
    echo "ðŸ“¦ Installing bore via Homebrew..."
    brew install bore-cli
    
    # Start bore tunnel
    echo "ðŸ”„ Starting bore tunnel..."
    bore local 8080 --to bore.pub > bore.log 2>&1 &
    sleep 15
    
    # Extract bore URL
    BORE_URL=$(grep -o 'bore\.pub:[0-9]*' bore.log | head -1)
    
    if [ ! -z "$BORE_URL" ]; then
        echo "ðŸš€ METHOD 1 - Bore.pub:"
        echo "   URL: http://$BORE_URL"
        echo "   ðŸ‘¤ Terminal Login: admin / ${{ github.event.inputs.session_password }}"
        echo "   âœ… No tunnel password required!"
        echo "$BORE_URL" > bore_url.txt
    else
        echo "âš ï¸  Bore tunnel failed, trying alternatives..."
    fi
    
    # Method 2: Try cloudflared tunnel
    echo "ðŸŒ Setting up Cloudflare tunnel as backup..."
    brew install cloudflared
    
    # Start cloudflared tunnel
    cloudflared tunnel --url http://localhost:8080 > cloudflare.log 2>&1 &
    sleep 15
    
    # Extract cloudflare URL
    CF_URL=$(grep -o 'https://[^[:space:]]*\.trycloudflare\.com' cloudflare.log | head -1)
    
    if [ ! -z "$CF_URL" ]; then
        echo "â˜ï¸  METHOD 2 - Cloudflare Tunnel:"
        echo "   URL: $CF_URL"
        echo "   ðŸ‘¤ Terminal Login: admin / ${{ github.event.inputs.session_password }}"
        echo "   âœ… No tunnel password required!"
        echo "$CF_URL" > cloudflare_url.txt
    fi
    
    # Method 3: Try ngrok alternative - zrok
    echo "ðŸ”— Setting up zrok tunnel..."
    curl -sSLf https://get.openziti.io/tun/install.sh | bash
    
    if command -v zrok &> /dev/null; then
        zrok share public http://localhost:8080 > zrok.log 2>&1 &
        sleep 10
        
        ZROK_URL=$(grep -o 'https://[^[:space:]]*' zrok.log | head -1)
        if [ ! -z "$ZROK_URL" ]; then
            echo "ðŸ”— METHOD 3 - Zrok Tunnel:"
            echo "   URL: $ZROK_URL"
            echo "   ðŸ‘¤ Terminal Login: admin / ${{ github.event.inputs.session_password }}"
            echo "   âœ… No registration required!"
        fi
    fi
